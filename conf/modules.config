process {

    withName: PREFETCH {
        ext.args = "--max-size 150g"
    }

    withName: FASTERQ_DUMP {
        publishDir = [
            path: { "data/" },
            mode: params.publish_dir_mode,
        ]
    }
    withName: CELLRANGER {
        publishDir = [
            path: { "${meta.outdir}/${meta.analysis_subdir}" },
            mode: params.publish_dir_mode,
        ]
    }

    withName: STAR_GENOMEGENERATE {
        publishDir = [
            path: { "data/references/Mus_musculus/Ensembl/GRCm38/Sequence/"},
            mode: params.publish_dir_mode,
        ]
    }

    withName: ST_PIPELINE {
        publishDir = [
            path: { "${params.outdir}/st_pipeline" },
            mode: params.publish_dir_mode,
        ]
        ext.args = "--htseq-no-ambiguous --verbose --umi-start-position 16 --umi-end-position 26 --demultiplexing-overhang 0 --min-length-qual-trimming 20"
    }

    // CUTADAPT options
    withName: CUTADAPT_PRIMER {
        ext.args = "-g ${params.primer_seq}"
    }
    withName: CUTADAPT_LINKER1 {
        ext.args = "-g ${params.linker1_seq}"
    }
    withName: CUTADAPT_LINKER2 {
        ext.args = "-g ${params.linker2_seq}"
    }

}